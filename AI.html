<!DOCTYPE html>
<html lang="ar" dir="rtl" class="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Omar Fergany - Advanced AI Development Platform</title>
  <meta name="description" content="Professional AI-powered development platform with advanced tools, project management, and intelligent assistance">
  <meta name="keywords" content="AI, development, programming, assistant, project management, code editor">
  <meta name="author" content="Omar Fergany">
  
  <!-- Progressive Web App -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0d9488">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="icons/icon-192x192.png">
  
  <!-- External Libraries -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600&family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
  
  <!-- Core Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>

  <style>
      /* ==============================================
      ADVANCED AI DEVELOPMENT PLATFORM - CSS STYLES
      Professional, Modern, and Feature-Rich Design
      ==============================================
      */

      /* --- Enhanced CSS Variables for Advanced Theming --- */
      :root {
          /* Primary Colors */
          --primary-100: #f0fdfa;
          --primary-200: #ccfbf1;
          --primary-300: #99f6e4;
          --primary-400: #5eead4;
          --primary-500: #2dd4bf;
          --primary-600: #14b8a6;
          --primary-700: #0d9488;
          --primary-800: #0f766e;
          --primary-900: #134e4a;
          
          /* Neutral Colors */
          --neutral-50: #fafafa;
          --neutral-100: #f4f4f5;
          --neutral-200: #e4e4e7;
          --neutral-300: #d4d4d8;
          --neutral-400: #a1a1aa;
          --neutral-500: #71717a;
          --neutral-600: #52525b;
          --neutral-700: #3f3f46;
          --neutral-800: #27272a;
          --neutral-900: #18181b;
          
          /* Semantic Colors */
          --success-50: #f0fdf4;
          --success-500: #22c55e;
          --success-600: #16a34a;
          --warning-50: #fffbeb;
          --warning-500: #f59e0b;
          --warning-600: #d97706;
          --error-50: #fef2f2;
          --error-500: #ef4444;
          --error-600: #dc2626;
          --info-50: #eff6ff;
          --info-500: #3b82f6;
          --info-600: #2563eb;
          
          /* Light Theme Variables */
          --bg-primary: var(--neutral-50);
          --bg-secondary: #ffffff;
          --bg-tertiary: var(--neutral-100);
          --text-primary: var(--neutral-900);
          --text-secondary: var(--neutral-600);
          --text-tertiary: var(--neutral-400);
          --border-primary: var(--neutral-200);
          --border-secondary: var(--neutral-300);
          --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
          --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
          --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
          --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
          
          /* Glass Effects */
          --glass-bg: rgba(255, 255, 255, 0.8);
          --glass-border: rgba(255, 255, 255, 0.2);
          --backdrop-blur: blur(20px);
      }
      
      /* Dark Theme */
      html.dark {
          --bg-primary: var(--neutral-900);
          --bg-secondary: var(--neutral-800);
          --bg-tertiary: var(--neutral-700);
          --text-primary: var(--neutral-100);
          --text-secondary: var(--neutral-300);
          --text-tertiary: var(--neutral-500);
          --border-primary: var(--neutral-700);
          --border-secondary: var(--neutral-600);
          --glass-bg: rgba(0, 0, 0, 0.6);
          --glass-border: rgba(255, 255, 255, 0.1);
      }
      
      /* --- Advanced Base Styles --- */
      * {
          box-sizing: border-box;
          -webkit-font-smoothing: antialiased;
          -moz-osx-font-smoothing: grayscale;
      }
      
      html, body {
          height: 100%;
          width: 100%;
          margin: 0;
          padding: 0;
          font-family: 'Inter', 'Cairo', sans-serif;
          background: var(--bg-primary);
          color: var(--text-primary);
          overflow: hidden;
          scroll-behavior: smooth;
      }
      
      /* --- Professional Loading System --- */
      #advanced-preloader {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: linear-gradient(135deg, 
              var(--primary-600) 0%, 
              var(--primary-800) 25%, 
              var(--neutral-800) 50%, 
              var(--primary-900) 75%, 
              var(--neutral-900) 100%);
          background-size: 400% 400%;
          animation: gradient-shift 8s ease infinite;
          z-index: 10000;
          display: flex;
          align-items: center;
          justify-content: center;
          flex-direction: column;
          transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      @keyframes gradient-shift {
          0% { background-position: 0% 50%; }
          50% { background-position: 100% 50%; }
          100% { background-position: 0% 50%; }
      }
      
      #advanced-preloader.hidden {
          opacity: 0;
          visibility: hidden;
          transform: scale(0.8);
      }
      
      .advanced-loader {
          position: relative;
          width: 120px;
          height: 120px;
          margin-bottom: 2rem;
      }
      
      .loader-ring {
          position: absolute;
          border: 3px solid transparent;
          border-radius: 50%;
          animation: spin 2s linear infinite;
      }
      
      .loader-ring:nth-child(1) {
          width: 120px;
          height: 120px;
          border-top-color: #ffffff;
          border-right-color: rgba(255, 255, 255, 0.3);
          animation-duration: 2s;
      }
      
      .loader-ring:nth-child(2) {
          width: 90px;
          height: 90px;
          top: 15px;
          left: 15px;
          border-top-color: var(--primary-300);
          border-right-color: rgba(45, 212, 191, 0.3);
          animation-duration: 1.5s;
          animation-direction: reverse;
      }
      
      .loader-ring:nth-child(3) {
          width: 60px;
          height: 60px;
          top: 30px;
          left: 30px;
          border-top-color: var(--info-400);
          border-right-color: rgba(59, 130, 246, 0.3);
          animation-duration: 1s;
      }
      
      @keyframes spin {
          to { transform: rotate(360deg); }
      }
      
      .preloader-content {
          text-align: center;
          color: #ffffff;
      }
      
      .preloader-title {
          font-size: 2rem;
          font-weight: 800;
          margin-bottom: 0.5rem;
          background: linear-gradient(45deg, #ffffff, var(--primary-200));
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
      }
      
      .preloader-subtitle {
          font-size: 1.1rem;
          font-weight: 500;
          margin-bottom: 2rem;
          opacity: 0.9;
      }
      
      .progress-container {
          width: 300px;
          height: 8px;
          background: rgba(255, 255, 255, 0.2);
          border-radius: 4px;
          overflow: hidden;
          margin-bottom: 1rem;
          box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      
      .progress-bar {
          width: 0%;
          height: 100%;
          background: linear-gradient(90deg, 
              var(--primary-400), 
              var(--info-500), 
              var(--primary-600));
          background-size: 200% 100%;
          animation: progress-shimmer 2s ease-in-out infinite;
          transition: width 0.3s ease-out;
          border-radius: 4px;
      }
      
      @keyframes progress-shimmer {
          0% { background-position: -200% 0; }
          100% { background-position: 200% 0; }
      }
      
      .progress-text {
          font-size: 0.9rem;
          opacity: 0.8;
          margin-top: 0.5rem;
      }
      
      .enter-platform-btn {
          display: none;
          margin-top: 2rem;
          padding: 1rem 2rem;
          font-size: 1.1rem;
          font-weight: 600;
          color: #ffffff;
          background: linear-gradient(135deg, var(--primary-600), var(--primary-800));
          border: 2px solid rgba(255, 255, 255, 0.2);
          border-radius: 50px;
          cursor: pointer;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
          box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
          backdrop-filter: blur(10px);
      }
      
      .enter-platform-btn:hover {
          transform: translateY(-3px) scale(1.05);
          box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
          border-color: rgba(255, 255, 255, 0.4);
      }
      
      .enter-platform-btn:active {
          transform: translateY(-1px) scale(1.02);
      }

      /* --- Main Platform Layout --- */
      #main-platform {
          width: 100%;
          height: 100vh;
          display: flex;
          background: var(--bg-primary);
          opacity: 0;
          visibility: hidden;
          transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      #main-platform.visible {
          opacity: 1;
          visibility: visible;
      }
      
      /* --- Advanced Sidebar --- */
      .sidebar {
          width: 300px;
          height: 100%;
          background: var(--glass-bg);
          backdrop-filter: var(--backdrop-blur);
          border-right: 1px solid var(--border-primary);
          display: flex;
          flex-direction: column;
          position: relative;
          transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .sidebar.collapsed {
          width: 80px;
      }
      
      .sidebar-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--border-primary);
          display: flex;
          align-items: center;
          gap: 1rem;
      }
      
      .logo {
          width: 40px;
          height: 40px;
          background: linear-gradient(135deg, var(--primary-600), var(--primary-800));
          border-radius: 12px;
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-weight: 700;
          font-size: 1.2rem;
          box-shadow: var(--shadow-md);
      }
      
      .brand-text {
          flex: 1;
          overflow: hidden;
          transition: all 0.3s ease;
      }
      
      .brand-title {
          font-size: 1.2rem;
          font-weight: 700;
          margin: 0;
          color: var(--text-primary);
          white-space: nowrap;
      }
      
      .brand-subtitle {
          font-size: 0.8rem;
          color: var(--text-secondary);
          margin: 0;
          white-space: nowrap;
      }
      
      .sidebar-toggle {
          background: none;
          border: none;
          color: var(--text-secondary);
          cursor: pointer;
          padding: 0.5rem;
          border-radius: 8px;
          transition: all 0.2s ease;
      }
      
      .sidebar-toggle:hover {
          background: var(--bg-tertiary);
          color: var(--text-primary);
      }
      
      .sidebar.collapsed .brand-text {
          opacity: 0;
          width: 0;
      }
      
      /* --- Navigation Menu --- */
      .nav-menu {
          flex: 1;
          padding: 1rem;
          overflow-y: auto;
      }
      
      .nav-section {
          margin-bottom: 2rem;
      }
      
      .nav-section-title {
          font-size: 0.75rem;
          font-weight: 600;
          color: var(--text-tertiary);
          text-transform: uppercase;
          letter-spacing: 0.05em;
          margin-bottom: 0.5rem;
          padding: 0 0.75rem;
      }
      
      .sidebar.collapsed .nav-section-title {
          opacity: 0;
      }
      
      .nav-item {
          display: flex;
          align-items: center;
          gap: 0.75rem;
          padding: 0.75rem;
          margin-bottom: 0.25rem;
          border-radius: 12px;
          color: var(--text-secondary);
          text-decoration: none;
          font-weight: 500;
          transition: all 0.2s ease;
          cursor: pointer;
          position: relative;
      }
      
      .nav-item:hover {
          background: var(--bg-tertiary);
          color: var(--text-primary);
          transform: translateX(4px);
      }
      
      .nav-item.active {
          background: linear-gradient(135deg, var(--primary-100), var(--primary-50));
          color: var(--primary-700);
          box-shadow: var(--shadow-sm);
      }
      
      html.dark .nav-item.active {
          background: linear-gradient(135deg, rgba(13, 148, 136, 0.2), rgba(13, 148, 136, 0.1));
          color: var(--primary-400);
      }
      
      .nav-item-icon {
          width: 20px;
          text-align: center;
          flex-shrink: 0;
      }
      
      .nav-item-text {
          flex: 1;
          white-space: nowrap;
          overflow: hidden;
          transition: all 0.3s ease;
      }
      
      .sidebar.collapsed .nav-item-text {
          opacity: 0;
          width: 0;
      }
      
      .nav-badge {
          background: var(--primary-600);
          color: white;
          font-size: 0.7rem;
          padding: 0.2rem 0.5rem;
          border-radius: 10px;
          font-weight: 600;
          min-width: 18px;
          text-align: center;
      }
      
      /* --- User Profile Section --- */
      .user-profile {
          padding: 1rem;
          border-top: 1px solid var(--border-primary);
          display: flex;
          align-items: center;
          gap: 0.75rem;
          cursor: pointer;
          transition: all 0.2s ease;
      }
      
      .user-profile:hover {
          background: var(--bg-tertiary);
      }
      
      .user-avatar {
          width: 40px;
          height: 40px;
          border-radius: 50%;
          background: linear-gradient(135deg, var(--primary-600), var(--info-600));
          display: flex;
          align-items: center;
          justify-content: center;
          color: white;
          font-weight: 600;
          font-size: 1.1rem;
          flex-shrink: 0;
      }
      
      .user-info {
          flex: 1;
          overflow: hidden;
          transition: all 0.3s ease;
      }
      
      .user-name {
          font-weight: 600;
          color: var(--text-primary);
          margin: 0;
          font-size: 0.9rem;
          white-space: nowrap;
      }
      
      .user-status {
          font-size: 0.75rem;
          color: var(--text-secondary);
          margin: 0;
          white-space: nowrap;
      }
      
      .sidebar.collapsed .user-info {
          opacity: 0;
          width: 0;
      }
      /* --- Main Content Area --- */
      .main-content {
          flex: 1;
          height: 100%;
          display: flex;
          flex-direction: column;
          overflow: hidden;
      }
      
      /* --- Header Bar --- */
      .header-bar {
          height: 70px;
          background: var(--glass-bg);
          backdrop-filter: var(--backdrop-blur);
          border-bottom: 1px solid var(--border-primary);
          display: flex;
          align-items: center;
          justify-content: space-between;
          padding: 0 2rem;
          position: relative;
          z-index: 100;
      }
      
      .header-left {
          display: flex;
          align-items: center;
          gap: 1rem;
      }
      
      .page-title {
          font-size: 1.5rem;
          font-weight: 700;
          color: var(--text-primary);
          margin: 0;
      }
      
      .breadcrumb {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.9rem;
          color: var(--text-secondary);
      }
      
      .breadcrumb-separator {
          color: var(--text-tertiary);
      }
      
      .header-right {
          display: flex;
          align-items: center;
          gap: 1rem;
      }
      
      .search-bar {
          position: relative;
          width: 300px;
      }
      
      .search-input {
          width: 100%;
          padding: 0.75rem 1rem 0.75rem 2.5rem;
          border: 1px solid var(--border-primary);
          border-radius: 25px;
          background: var(--bg-secondary);
          color: var(--text-primary);
          font-size: 0.9rem;
          transition: all 0.2s ease;
      }
      
      .search-input:focus {
          outline: none;
          border-color: var(--primary-600);
          box-shadow: 0 0 0 3px rgba(13, 148, 136, 0.1);
      }
      
      .search-icon {
          position: absolute;
          left: 1rem;
          top: 50%;
          transform: translateY(-50%);
          color: var(--text-tertiary);
      }
      
      .header-actions {
          display: flex;
          align-items: center;
          gap: 0.5rem;
      }
      
      .header-btn {
          width: 40px;
          height: 40px;
          background: var(--bg-secondary);
          border: 1px solid var(--border-primary);
          border-radius: 10px;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          color: var(--text-secondary);
          transition: all 0.2s ease;
          position: relative;
      }
      
      .header-btn:hover {
          background: var(--bg-tertiary);
          color: var(--text-primary);
          transform: translateY(-1px);
      }
      
      .header-btn.active {
          background: var(--primary-600);
          color: white;
          border-color: var(--primary-600);
      }
      
      .notification-badge {
          position: absolute;
          top: -2px;
          right: -2px;
          width: 18px;
          height: 18px;
          background: var(--error-500);
          color: white;
          border-radius: 50%;
          font-size: 0.7rem;
          display: flex;
          align-items: center;
          justify-content: center;
          font-weight: 600;
      }
      
      /* --- Tab System --- */
      .tab-container {
          background: var(--bg-secondary);
          border-bottom: 1px solid var(--border-primary);
          display: flex;
          align-items: center;
          padding: 0 2rem;
          overflow-x: auto;
          scrollbar-width: none;
          -ms-overflow-style: none;
      }
      
      .tab-container::-webkit-scrollbar {
          display: none;
      }
      
      .tab {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 1rem 1.5rem;
          color: var(--text-secondary);
          background: transparent;
          border: none;
          cursor: pointer;
          transition: all 0.2s ease;
          white-space: nowrap;
          position: relative;
          font-weight: 500;
      }
      
      .tab:hover {
          color: var(--text-primary);
          background: var(--bg-tertiary);
      }
      
      .tab.active {
          color: var(--primary-600);
          background: var(--primary-50);
      }
      
      html.dark .tab.active {
          background: rgba(13, 148, 136, 0.1);
      }
      
      .tab.active::after {
          content: '';
          position: absolute;
          bottom: 0;
          left: 0;
          right: 0;
          height: 2px;
          background: var(--primary-600);
      }
      
      .tab-close {
          width: 16px;
          height: 16px;
          border-radius: 50%;
          background: var(--text-tertiary);
          color: var(--bg-secondary);
          border: none;
          cursor: pointer;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.7rem;
          opacity: 0;
          transition: all 0.2s ease;
      }
      
      .tab:hover .tab-close {
          opacity: 1;
      }
      
      .tab-close:hover {
          background: var(--error-500);
      }
      /* --- Content Panels --- */
      .content-panel {
          flex: 1;
          overflow: hidden;
          display: none;
          flex-direction: column;
      }
      
      .content-panel.active {
          display: flex;
      }
      
      .panel-content {
          flex: 1;
          padding: 2rem;
          overflow-y: auto;
          background: var(--bg-primary);
      }
      
      /* --- AI Assistant Panel --- */
      .ai-chat-container {
          height: 100%;
          display: flex;
          flex-direction: column;
          background: var(--bg-secondary);
          border-radius: 16px;
          box-shadow: var(--shadow-lg);
          overflow: hidden;
      }
      
      .chat-header {
          padding: 1.5rem;
          background: linear-gradient(135deg, var(--primary-600), var(--primary-800));
          color: white;
          display: flex;
          align-items: center;
          justify-content: space-between;
      }
      
      .chat-title {
          display: flex;
          align-items: center;
          gap: 1rem;
      }
      
      .ai-status {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.9rem;
      }
      
      .status-dot {
          width: 10px;
          height: 10px;
          background: var(--success-400);
          border-radius: 50%;
          animation: pulse-dot 2s infinite;
      }
      
      @keyframes pulse-dot {
          0%, 100% { opacity: 1; transform: scale(1); }
          50% { opacity: 0.7; transform: scale(1.2); }
      }
      
      .chat-controls {
          display: flex;
          align-items: center;
          gap: 1rem;
      }
      
      .theme-toggle {
          width: 50px;
          height: 26px;
          background: rgba(255, 255, 255, 0.2);
          border-radius: 26px;
          position: relative;
          cursor: pointer;
          transition: all 0.3s ease;
      }
      
      .theme-toggle::before {
          content: '';
          position: absolute;
          top: 3px;
          left: 3px;
          width: 20px;
          height: 20px;
          background: white;
          border-radius: 50%;
          transition: all 0.3s ease;
      }
      
      html.dark .theme-toggle::before {
          transform: translateX(24px);
      }
      
      html.dark .theme-toggle {
          background: var(--primary-400);
      }
      
      /* --- Chat Messages --- */
      .chat-messages {
          flex: 1;
          padding: 1.5rem;
          overflow-y: auto;
          display: flex;
          flex-direction: column;
          gap: 1.5rem;
          background: var(--bg-primary);
          background-image: radial-gradient(rgba(13, 148, 136, 0.05) 1px, transparent 1px);
          background-size: 20px 20px;
      }
      
      .message {
          display: flex;
          align-items: flex-start;
          gap: 1rem;
          animation: messageSlideIn 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      @keyframes messageSlideIn {
          from {
              opacity: 0;
              transform: translateY(20px) scale(0.95);
          }
          to {
              opacity: 1;
              transform: translateY(0) scale(1);
          }
      }
      
      .message.user {
          flex-direction: row-reverse;
      }
      
      .message-avatar {
          width: 40px;
          height: 40px;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-weight: 600;
          font-size: 1.1rem;
          flex-shrink: 0;
      }
      
      .message.user .message-avatar {
          background: linear-gradient(135deg, var(--primary-600), var(--primary-800));
          color: white;
      }
      
      .message.ai .message-avatar {
          background: linear-gradient(135deg, var(--info-600), var(--info-800));
          color: white;
      }
      
      .message-content {
          flex: 1;
          max-width: 70%;
          background: var(--bg-secondary);
          padding: 1rem 1.25rem;
          border-radius: 18px;
          box-shadow: var(--shadow-sm);
          border: 1px solid var(--border-primary);
          position: relative;
      }
      
      .message.user .message-content {
          background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
          color: white;
          border-color: transparent;
      }
      
      .message-content p {
          margin: 0 0 0.5rem 0;
          line-height: 1.6;
      }
      
      .message-content p:last-child {
          margin-bottom: 0;
      }
      
      .message-time {
          font-size: 0.75rem;
          color: var(--text-tertiary);
          margin-top: 0.5rem;
      }
      
      .message.user .message-time {
          color: rgba(255, 255, 255, 0.7);
      }
      
      /* --- Code Blocks --- */
      .message-content pre {
          background: var(--bg-tertiary);
          border: 1px solid var(--border-primary);
          border-radius: 8px;
          padding: 1rem;
          margin: 0.5rem 0;
          overflow-x: auto;
          font-family: 'JetBrains Mono', monospace;
          font-size: 0.9rem;
      }
      
      .message-content code {
          background: var(--bg-tertiary);
          padding: 0.2rem 0.4rem;
          border-radius: 4px;
          font-family: 'JetBrains Mono', monospace;
          font-size: 0.9rem;
      }
      
      /* --- Quick Actions --- */
      .quick-actions {
          padding: 1rem 1.5rem;
          background: var(--bg-secondary);
          border-top: 1px solid var(--border-primary);
          display: flex;
          flex-wrap: wrap;
          gap: 0.75rem;
          overflow-x: auto;
      }
      
      .quick-action {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.6rem 1rem;
          background: var(--bg-primary);
          border: 1px solid var(--border-primary);
          border-radius: 20px;
          color: var(--text-secondary);
          font-size: 0.9rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s ease;
          white-space: nowrap;
      }
      
      .quick-action:hover {
          background: var(--primary-50);
          border-color: var(--primary-300);
          color: var(--primary-700);
          transform: translateY(-1px);
      }
      
      html.dark .quick-action:hover {
          background: rgba(13, 148, 136, 0.1);
          color: var(--primary-400);
      }
      
      .quick-action.featured {
          background: var(--primary-50);
          border-color: var(--primary-300);
          color: var(--primary-700);
      }
      
      html.dark .quick-action.featured {
          background: rgba(13, 148, 136, 0.1);
          color: var(--primary-400);
      }
      
      /* --- Chat Input Area --- */
      .chat-input-container {
          padding: 1.5rem;
          background: var(--bg-secondary);
          border-top: 1px solid var(--border-primary);
      }
      
      .input-wrapper {
          position: relative;
          display: flex;
          align-items: flex-end;
          gap: 1rem;
          background: var(--bg-primary);
          border: 2px solid var(--border-primary);
          border-radius: 20px;
          padding: 0.75rem 1rem;
          transition: all 0.2s ease;
      }
      
      .input-wrapper:focus-within {
          border-color: var(--primary-600);
          box-shadow: 0 0 0 3px rgba(13, 148, 136, 0.1);
      }
      
      .input-actions {
          display: flex;
          align-items: center;
          gap: 0.5rem;
      }
      
      .input-btn {
          width: 36px;
          height: 36px;
          background: none;
          border: none;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          color: var(--text-secondary);
          transition: all 0.2s ease;
      }
      
      .input-btn:hover {
          background: var(--bg-tertiary);
          color: var(--text-primary);
      }
      
      .input-btn.active {
          background: var(--primary-100);
          color: var(--primary-600);
      }
      
      html.dark .input-btn.active {
          background: rgba(13, 148, 136, 0.2);
      }
      
      .chat-input {
          flex: 1;
          border: none;
          outline: none;
          background: transparent;
          color: var(--text-primary);
          font-size: 1rem;
          line-height: 1.5;
          resize: none;
          min-height: 24px;
          max-height: 120px;
          padding: 0.5rem 0;
      }
      
      .chat-input::placeholder {
          color: var(--text-tertiary);
      }
      
      .send-btn {
          width: 40px;
          height: 40px;
          background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
          border: none;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          cursor: pointer;
          color: white;
          transition: all 0.2s ease;
          box-shadow: var(--shadow-md);
      }
      
      .send-btn:hover {
          transform: scale(1.05);
          box-shadow: var(--shadow-lg);
      }
      
      .send-btn:active {
          transform: scale(0.95);
      }
      
      .send-btn:disabled {
          opacity: 0.5;
          cursor: not-allowed;
          transform: none;
      }
      
      /* --- Advanced Dashboard Components --- */
      .dashboard-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 1.5rem;
          margin-bottom: 2rem;
      }
      
      .stat-card {
          background: var(--bg-secondary);
          border: 1px solid var(--border-primary);
          border-radius: 16px;
          padding: 1.5rem;
          box-shadow: var(--shadow-sm);
          transition: all 0.2s ease;
      }
      
      .stat-card:hover {
          box-shadow: var(--shadow-md);
          transform: translateY(-2px);
      }
      
      /* --- Responsive Design --- */
      @media (max-width: 768px) {
          .sidebar {
              position: absolute;
              left: -300px;
              z-index: 1000;
              width: 280px;
              box-shadow: var(--shadow-xl);
          }
          
          .sidebar.open {
              left: 0;
          }
          
          .main-content {
              width: 100%;
          }
          
          .header-bar {
              padding: 0 1rem;
          }
          
          .search-bar {
              width: 200px;
          }
          
          .page-title {
              font-size: 1.2rem;
          }
          
          .panel-content {
              padding: 1rem;
          }
      }
      
      /* --- Loading States --- */
      .loading {
          opacity: 0.6;
          pointer-events: none;
      }
      
      .spinner {
          width: 20px;
          height: 20px;
          border: 2px solid var(--border-primary);
          border-top-color: var(--primary-600);
          border-radius: 50%;
          animation: spin 1s linear infinite;
      }
      
      /* --- Animations --- */
      @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
      }
      
      @keyframes slideInRight {
          from { opacity: 0; transform: translateX(20px); }
          to { opacity: 1; transform: translateX(0); }
      }
      
      .animate-fade-in {
          animation: fadeIn 0.5s ease-out;
      }
      
      .animate-slide-in {
          animation: slideInRight 0.3s ease-out;
      }
      
      /* --- Enhanced Footer Styles --- */
      .chat-footer{
          flex-shrink:0;
          background:var(--chat-bg-calm-secondary);
          border-top:1px solid var(--border-color);
          box-shadow:0 -5px 20px -5px rgba(0,0,0,.05);
      }
      #chat-quick-replies{
          padding:.75rem 1rem;
          display:flex;
          flex-wrap:wrap;
          gap:.5rem;
          justify-content:center;
          border-bottom:1px solid var(--border-color);
          max-height:120px;
          overflow-y:auto;
      }
      .quick-reply-btn{
          background:transparent;
          border:1px solid var(--primary-color);
          color:var(--primary-color);
          padding:.4rem 1rem;
          font-size:.85rem;
          border-radius:16px;
          cursor:pointer;
          transition:all .2s ease-in-out;
          font-weight:600;
      }
      .quick-reply-btn:hover{
          background-color:var(--primary-color);
          color:#fff;
          transform:translateY(-1px);
          box-shadow: 0 4px 8px rgba(13,148,136,.2);
      }
      .quick-reply-btn.gemini-feature{
          background-color:var(--gemini-feature-bg);
          border-color:var(--gemini-feature-border);
      }
      #chat-input-wrapper{
          display:flex;
          align-items:center;
          padding:.75rem 1rem;
      }
      #image-upload-btn{
          background:none;
          border:none;
          color:var(--text-secondary-color);
          font-size:1.5rem;
          cursor:pointer;
          transition:all .2s;
          padding:.5rem;
          border-radius: 8px;
      }
      #image-upload-btn:hover{
          color:var(--primary-color);
          background-color: var(--gemini-feature-bg);
      }
      #chat-input{
          flex-grow:1;
          border:2px solid var(--border-color);
          background:var(--chat-bg-calm);
          padding:.6rem 1rem;
          color:var(--text-color);
          outline:none;
          border-radius:20px;
          font-size:1rem;
          transition:all .3s ease;
          margin:0 .75rem;
      }
      #chat-input:focus{
          border-color:var(--primary-color);
          box-shadow:0 0 0 3px rgba(13,148,136,.1);
      }
      #chat-send-btn{
          background:linear-gradient(135deg,var(--primary-color),var(--primary-hover-color));
          color:#fff;
          border:none;
          border-radius:50%;
          width:48px;
          height:48px;
          font-size:1.2rem;
          cursor:pointer;
          display:flex;
          align-items:center;
          justify-content:center;
          transition:all .3s ease;
          box-shadow:0 4px 12px rgba(13,148,136,.3);
      }
      #chat-send-btn:hover{
          transform:scale(1.1);
          box-shadow:0 6px 16px rgba(13,148,136,.4);
      }
      #chat-send-btn:active{
          transform:scale(.95);
      }
  </style>
</head>
<body>
  <!-- Advanced Preloader -->
  <div id="advanced-preloader">
    <div class="advanced-loader">
      <div class="loader-ring"></div>
      <div class="loader-ring"></div>
      <div class="loader-ring"></div>
    </div>
    <div class="preloader-content">
      <h1 class="preloader-title">Omar Fergany</h1>
      <p class="preloader-subtitle">Advanced AI Development Platform</p>
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      <p class="progress-text" id="progress-text">Initializing AI systems...</p>
      <button class="enter-platform-btn" id="enter-platform-btn">Enter Platform</button>
    </div>
  </div>

  <!-- Startup Sound -->
  <audio id="startup-sound" src="https://cdn.pixabay.com/audio/2022/11/17/audio_83542d2493.mp3" preload="auto"></audio>

  <!-- Main Platform -->
  <div id="main-platform">
    <!-- Advanced Sidebar -->
    <div class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="logo">OF</div>
        <div class="brand-text">
          <h3 class="brand-title">Omar Platform</h3>
          <p class="brand-subtitle">AI Development Suite</p>
        </div>
        <button class="sidebar-toggle" id="sidebar-toggle">
          <i class="fas fa-bars"></i>
        </button>
      </div>
      
      <nav class="nav-menu">
        <div class="nav-section">
          <p class="nav-section-title">Main</p>
          <a href="#" class="nav-item active" data-tab="dashboard">
            <i class="fas fa-chart-pie nav-item-icon"></i>
            <span class="nav-item-text">Dashboard</span>
          </a>
          <a href="#" class="nav-item" data-tab="ai-assistant">
            <i class="fas fa-robot nav-item-icon"></i>
            <span class="nav-item-text">AI Assistant</span>
            <span class="nav-badge">Pro</span>
          </a>
          <a href="#" class="nav-item" data-tab="projects">
            <i class="fas fa-folder-open nav-item-icon"></i>
            <span class="nav-item-text">Projects</span>
          </a>
        </div>
        
        <div class="nav-section">
          <p class="nav-section-title">Development</p>
          <a href="#" class="nav-item" data-tab="code-editor">
            <i class="fas fa-code nav-item-icon"></i>
            <span class="nav-item-text">Code Editor</span>
          </a>
          <a href="#" class="nav-item" data-tab="database">
            <i class="fas fa-database nav-item-icon"></i>
            <span class="nav-item-text">Database</span>
          </a>
          <a href="#" class="nav-item" data-tab="api-testing">
            <i class="fas fa-exchange-alt nav-item-icon"></i>
            <span class="nav-item-text">API Testing</span>
          </a>
        </div>
        
        <div class="nav-section">
          <p class="nav-section-title">Business</p>
          <a href="#" class="nav-item" data-tab="clients">
            <i class="fas fa-users nav-item-icon"></i>
            <span class="nav-item-text">Clients</span>
            <span class="nav-badge">12</span>
          </a>
          <a href="#" class="nav-item" data-tab="analytics">
            <i class="fas fa-chart-line nav-item-icon"></i>
            <span class="nav-item-text">Analytics</span>
          </a>
          <a href="#" class="nav-item" data-tab="settings">
            <i class="fas fa-cog nav-item-icon"></i>
            <span class="nav-item-text">Settings</span>
          </a>
        </div>
      </nav>
      
      <div class="user-profile">
        <div class="user-avatar">OF</div>
        <div class="user-info">
          <p class="user-name">Omar Fergany</p>
          <p class="user-status">Senior Developer</p>
        </div>
    <!-- Main Content Area -->
    <div class="main-content">
      <!-- Header Bar -->
      <div class="header-bar">
        <div class="header-left">
          <h1 class="page-title" id="page-title">Dashboard</h1>
          <nav class="breadcrumb">
            <span>Platform</span>
            <i class="fas fa-chevron-right breadcrumb-separator"></i>
            <span id="breadcrumb-current">Dashboard</span>
          </nav>
        </div>
        
        <div class="header-right">
          <div class="search-bar">
            <i class="fas fa-search search-icon"></i>
            <input type="text" class="search-input" placeholder="Search anything...">
          </div>
          
          <div class="header-actions">
            <button class="header-btn" id="notifications-btn" title="Notifications">
              <i class="fas fa-bell"></i>
              <span class="notification-badge">3</span>
            </button>
            <button class="header-btn" id="theme-btn" title="Toggle Theme">
              <i class="fas fa-moon"></i>
            </button>
            <button class="header-btn" id="fullscreen-btn" title="Fullscreen">
              <i class="fas fa-expand"></i>
            </button>
          </div>
        </div>
      </div>
      
      <!-- Tab Container -->
      <div class="tab-container">
        <button class="tab active" data-tab="dashboard">
          <i class="fas fa-chart-pie"></i>
          <span>Dashboard</span>
        </button>
        <button class="tab" data-tab="ai-assistant">
          <i class="fas fa-robot"></i>
          <span>AI Assistant</span>
        </button>
        <button class="tab" data-tab="projects">
          <i class="fas fa-folder-open"></i>
          <span>Projects</span>
        </button>
        <button class="tab" data-tab="code-editor">
          <i class="fas fa-code"></i>
          <span>Code Editor</span>
        </button>
      </div>
      
      <!-- Content Panels -->
      <!-- Dashboard Panel -->
      <div class="content-panel active" id="dashboard-panel">
        <div class="panel-content">
          <div class="dashboard-grid">
            <div class="stat-card">
              <div class="stat-header">
                <span class="stat-title">Total Projects</span>
                <div class="stat-icon primary">
                  <i class="fas fa-folder"></i>
                </div>
              </div>
              <div class="stat-value">24</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span>+12% from last month</span>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-header">
                <span class="stat-title">Active Clients</span>
                <div class="stat-icon success">
                  <i class="fas fa-users"></i>
                </div>
              </div>
              <div class="stat-value">12</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span>+3 new this week</span>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-header">
                <span class="stat-title">Revenue</span>
                <div class="stat-icon warning">
                  <i class="fas fa-dollar-sign"></i>
                </div>
              </div>
              <div class="stat-value">$45,230</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span>+8.2% this month</span>
              </div>
            </div>
            
            <div class="stat-card">
              <div class="stat-header">
                <span class="stat-title">AI Queries</span>
                <div class="stat-icon info">
                  <i class="fas fa-brain"></i>
                </div>
              </div>
              <div class="stat-value">1,847</div>
              <div class="stat-change positive">
                <i class="fas fa-arrow-up"></i>
                <span>+234 today</span>
              </div>
            </div>
          </div>
          
          <!-- Recent Projects -->
          <div class="project-grid">
            <div class="project-card">
              <div class="project-header">
                <h3 class="project-title">E-commerce Platform</h3>
                <p class="project-description">Full-stack web application with AI recommendations</p>
              </div>
              <div class="project-body">
                <div class="project-stats">
                  <div class="project-stat">
                    <div class="project-stat-value">85%</div>
                    <div class="project-stat-label">Complete</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">12</div>
                    <div class="project-stat-label">Tasks</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">5</div>
                    <div class="project-stat-label">Team</div>
                  </div>
                </div>
                
                <div class="project-progress">
                  <div class="progress-label">
                    <span>Progress</span>
                    <span>85%</span>
                  </div>
                  <div class="progress-bar-bg">
                    <div class="progress-bar-fill" style="width: 85%"></div>
                  </div>
                </div>
                
                <div class="project-tags">
                  <span class="project-tag">React</span>
                  <span class="project-tag">Node.js</span>
                  <span class="project-tag">AI/ML</span>
                </div>
              </div>
            </div>
            
            <div class="project-card">
              <div class="project-header">
                <h3 class="project-title">Mobile Banking App</h3>
                <p class="project-description">Secure mobile banking with biometric authentication</p>
              </div>
              <div class="project-body">
                <div class="project-stats">
                  <div class="project-stat">
                    <div class="project-stat-value">92%</div>
                    <div class="project-stat-label">Complete</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">8</div>
                    <div class="project-stat-label">Tasks</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">3</div>
                    <div class="project-stat-label">Team</div>
                  </div>
                </div>
                
                <div class="project-progress">
                  <div class="progress-label">
                    <span>Progress</span>
                    <span>92%</span>
                  </div>
                  <div class="progress-bar-bg">
                    <div class="progress-bar-fill" style="width: 92%"></div>
                  </div>
                </div>
                
                <div class="project-tags">
                  <span class="project-tag">Flutter</span>
                  <span class="project-tag">Firebase</span>
                  <span class="project-tag">Security</span>
                </div>
              </div>
            </div>
            
            <div class="project-card">
              <div class="project-header">
                <h3 class="project-title">AI Content Generator</h3>
                <p class="project-description">Advanced AI system for content creation and optimization</p>
              </div>
              <div class="project-body">
                <div class="project-stats">
                  <div class="project-stat">
                    <div class="project-stat-value">67%</div>
                    <div class="project-stat-label">Complete</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">18</div>
                    <div class="project-stat-label">Tasks</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">7</div>
                    <div class="project-stat-label">Team</div>
                  </div>
                </div>
                
                <div class="project-progress">
                  <div class="progress-label">
                    <span>Progress</span>
                    <span>67%</span>
                  </div>
                  <div class="progress-bar-bg">
                    <div class="progress-bar-fill" style="width: 67%"></div>
                  </div>
                </div>
                
                <div class="project-tags">
                  <span class="project-tag">Python</span>
                  <span class="project-tag">TensorFlow</span>
                  <span class="project-tag">NLP</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- AI Assistant Panel -->
      <div class="content-panel" id="ai-assistant-panel">
        <div class="ai-chat-container">
          <div class="chat-header">
            <div class="chat-title">
              <div class="ai-status">
                <div class="status-dot"></div>
                <span>AI Assistant Online</span>
              </div>
              <h3 style="margin: 0; font-size: 1.2rem;">Omar's Personal AI Assistant</h3>
            </div>
            
            <div class="chat-controls">
              <div class="theme-toggle" id="chat-theme-toggle"></div>
            </div>
          </div>
          
          <div class="chat-messages" id="chat-messages"></div>
          
          <div class="quick-actions" id="quick-actions">
            <button class="quick-action featured" data-action="about-omar">
              <i class="fas fa-user"></i>
              <span>About Omar</span>
            </button>
            <button class="quick-action" data-action="contact-info">
              <i class="fas fa-address-card"></i>
              <span>Contact Info</span>
            </button>
            <button class="quick-action" data-action="smart-tools">
              <i class="fas fa-magic"></i>
              <span>Smart Tools</span>
            </button>
            <button class="quick-action" data-action="code-review">
              <i class="fas fa-code"></i>
              <span>Code Review</span>
            </button>
            <button class="quick-action" data-action="project-ideas">
              <i class="fas fa-lightbulb"></i>
              <span>Project Ideas</span>
            </button>
            <button class="quick-action" data-action="image-analysis">
              <i class="fas fa-image"></i>
              <span>Analyze Image</span>
            </button>
          </div>
          
          <div class="chat-input-container">
            <div class="input-wrapper">
              <div class="input-actions">
                <input type="file" id="file-input" accept="image/*,.pdf,.doc,.docx,.txt" style="display: none;">
                <button class="input-btn" id="attach-btn" title="Attach File">
                  <i class="fas fa-paperclip"></i>
                </button>
                <button class="input-btn" id="voice-btn" title="Voice Input">
                  <i class="fas fa-microphone"></i>
                </button>
                <button class="input-btn" id="emoji-btn" title="Add Emoji">
                  <i class="fas fa-smile"></i>
                </button>
              </div>
              
              <textarea 
                class="chat-input" 
                id="chat-input" 
                placeholder="Ask me anything about Omar or use AI tools..."
                rows="1"></textarea>
              
              <button class="send-btn" id="send-btn">
                <i class="fas fa-paper-plane"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Projects Panel -->
      <div class="content-panel" id="projects-panel">
        <div class="panel-content">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <h2 style="margin: 0; color: var(--text-primary);">All Projects</h2>
            <button style="padding: 0.75rem 1.5rem; background: var(--primary-600); color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">
              <i class="fas fa-plus"></i> New Project
            </button>
          </div>
          
          <div class="project-grid">
            <div class="project-card">
              <div class="project-header">
                <h3 class="project-title">Healthcare Management System</h3>
                <p class="project-description">Complete hospital management solution with patient tracking</p>
              </div>
              <div class="project-body">
                <div class="project-stats">
                  <div class="project-stat">
                    <div class="project-stat-value">78%</div>
                    <div class="project-stat-label">Complete</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">25</div>
                    <div class="project-stat-label">Tasks</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">8</div>
                    <div class="project-stat-label">Team</div>
                  </div>
                </div>
                
                <div class="project-progress">
                  <div class="progress-label">
                    <span>Progress</span>
                    <span>78%</span>
                  </div>
                  <div class="progress-bar-bg">
                    <div class="progress-bar-fill" style="width: 78%"></div>
                  </div>
                </div>
                
                <div class="project-tags">
                  <span class="project-tag">Vue.js</span>
                  <span class="project-tag">Laravel</span>
                  <span class="project-tag">MySQL</span>
                </div>
              </div>
            </div>
            
            <div class="project-card">
              <div class="project-header">
                <h3 class="project-title">Real Estate Platform</h3>
                <p class="project-description">Property listing and management with virtual tours</p>
              </div>
              <div class="project-body">
                <div class="project-stats">
                  <div class="project-stat">
                    <div class="project-stat-value">45%</div>
                    <div class="project-stat-label">Complete</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">32</div>
                    <div class="project-stat-label">Tasks</div>
                  </div>
                  <div class="project-stat">
                    <div class="project-stat-value">6</div>
                    <div class="project-stat-label">Team</div>
                  </div>
                </div>
                
                <div class="project-progress">
                  <div class="progress-label">
                    <span>Progress</span>
                    <span>45%</span>
                  </div>
                  <div class="progress-bar-bg">
                    <div class="progress-bar-fill" style="width: 45%"></div>
                  </div>
                </div>
                
                <div class="project-tags">
                  <span class="project-tag">Angular</span>
                  <span class="project-tag">Node.js</span>
                  <span class="project-tag">MongoDB</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Code Editor Panel -->
      <div class="content-panel" id="code-editor-panel">
        <div class="panel-content" style="padding: 0; height: 100%;">
          <div style="height: 100%; display: flex; flex-direction: column;">
            <div style="padding: 1rem; background: var(--bg-secondary); border-bottom: 1px solid var(--border-primary); display: flex; justify-content: space-between; align-items: center;">
              <h3 style="margin: 0; color: var(--text-primary);">Advanced Code Editor</h3>
              <div style="display: flex; gap: 0.5rem;">
                <button style="padding: 0.5rem 1rem; background: var(--primary-600); color: white; border: none; border-radius: 6px; cursor: pointer;">
                  <i class="fas fa-play"></i> Run
                </button>
                <button style="padding: 0.5rem 1rem; background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-primary); border-radius: 6px; cursor: pointer;">
                  <i class="fas fa-save"></i> Save
                </button>
              </div>
            </div>
            <div id="monaco-editor" style="flex: 1; min-height: 400px;"></div>
          </div>
        </div>
      </div>
    </div>
  
<script>
/* ==============================================
ADVANCED AI DEVELOPMENT PLATFORM - JAVASCRIPT
Professional, Feature-Rich, and Intelligent
==============================================
*/

class AdvancedPlatform {
    constructor() {
        this.currentTab = 'dashboard';
        this.aiAssistant = null;
        this.codeEditor = null;
        this.initialized = false;
        this.API_KEY = "AIzaSyAOg-GwRizftAonNqOEg37HMMqH4oNT9EM";
        
        this.init();
    }
    
    async init() {
        await this.initPreloader();
        this.initTheme();
        this.initNavigation();
        this.initAIAssistant();
        this.initCodeEditor();
        this.initResponsive();
        this.initialized = true;
    }
    
    async initPreloader() {
        const preloader = document.getElementById('advanced-preloader');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const enterBtn = document.getElementById('enter-platform-btn');
        const startupSound = document.getElementById('startup-sound');
        const mainPlatform = document.getElementById('main-platform');
        
        const loadingSteps = [
            "Initializing AI systems...",
            "Loading advanced components...",
            "Connecting to Gemini API...",
            "Setting up code editor...",
            "Preparing dashboard analytics...",
            "Optimizing performance...",
            "🚀 Platform ready!"
        ];
        
        let progress = 0;
        let stepIndex = 0;
        
        const loadingInterval = setInterval(() => {
            progress += Math.random() * 15 + 5;
            if (progress > 100) progress = 100;
            
            progressBar.style.width = progress + '%';
            
            const nextStep = Math.floor(progress / 15);
            if (nextStep > stepIndex && nextStep < loadingSteps.length) {
                stepIndex = nextStep;
                progressText.textContent = loadingSteps[stepIndex];
            }
            
            if (progress >= 100) {
                clearInterval(loadingInterval);
                progressText.textContent = loadingSteps[loadingSteps.length - 1];
                setTimeout(() => {
                    enterBtn.style.display = 'block';
                    enterBtn.classList.add('animate-fade-in');
                }, 500);
            }
        }, 200);
        
        enterBtn.addEventListener('click', () => {
            startupSound.play().catch(e => console.log('Autoplay prevented'));
            preloader.classList.add('hidden');
            setTimeout(() => {
                mainPlatform.classList.add('visible');
                this.showWelcomeMessage();
            }, 800);
        });
    }
    
    initTheme() {
        const themeBtn = document.getElementById('theme-btn');
        const html = document.documentElement;
        
        const currentTheme = localStorage.getItem('theme') || 'light';
        html.classList.add(currentTheme);
        this.updateThemeIcon(currentTheme);
        
        themeBtn?.addEventListener('click', () => {
            const newTheme = html.classList.contains('dark') ? 'light' : 'dark';
            html.classList.remove('light', 'dark');
            html.classList.add(newTheme);
            localStorage.setItem('theme', newTheme);
            this.updateThemeIcon(newTheme);
        });
    }
    
    updateThemeIcon(theme) {
        const themeBtn = document.getElementById('theme-btn');
        const icon = themeBtn?.querySelector('i');
        if (icon) {
            icon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
        }
    }
    
    initNavigation() {
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const sidebar = document.getElementById('sidebar');
        const navItems = document.querySelectorAll('.nav-item');
        const tabs = document.querySelectorAll('.tab');
        const panels = document.querySelectorAll('.content-panel');
        const pageTitle = document.getElementById('page-title');
        const breadcrumbCurrent = document.getElementById('breadcrumb-current');
        
        // Sidebar toggle
        sidebarToggle?.addEventListener('click', () => {
            sidebar.classList.toggle('collapsed');
        });
        
        // Navigation handling
        [...navItems, ...tabs].forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                const tab = item.dataset.tab;
                if (tab) {
                    this.switchTab(tab);
                }
            });
        });
    }
    
    switchTab(tabName) {
        // Update active states
        document.querySelectorAll('.nav-item, .tab').forEach(item => {
            item.classList.toggle('active', item.dataset.tab === tabName);
        });
        
        // Switch panels
        document.querySelectorAll('.content-panel').forEach(panel => {
            panel.classList.toggle('active', panel.id === `${tabName}-panel`);
        });
        
        // Update header
        const titles = {
            'dashboard': 'Dashboard',
            'ai-assistant': 'AI Assistant',
            'projects': 'Projects',
            'code-editor': 'Code Editor',
            'database': 'Database',
            'api-testing': 'API Testing',
            'clients': 'Clients',
            'analytics': 'Analytics',
            'settings': 'Settings'
        };
        
        const pageTitle = document.getElementById('page-title');
        const breadcrumbCurrent = document.getElementById('breadcrumb-current');
        
        if (pageTitle) pageTitle.textContent = titles[tabName] || 'Platform';
        if (breadcrumbCurrent) breadcrumbCurrent.textContent = titles[tabName] || 'Platform';
        
        this.currentTab = tabName;
        
        // Initialize tab-specific features
        if (tabName === 'code-editor' && !this.codeEditor) {
            this.initCodeEditor();
        }
    }
    
    initAIAssistant() {
        this.aiAssistant = new AIAssistant(this.API_KEY);
    }
    
    initCodeEditor() {
        if (typeof monaco !== 'undefined') {
            const editorContainer = document.getElementById('monaco-editor');
            if (editorContainer && !this.codeEditor) {
                require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' } });
                require(['vs/editor/editor.main'], () => {
                    this.codeEditor = monaco.editor.create(editorContainer, {
                        value: `// Welcome to Omar's Advanced Code Editor
// Powered by Monaco Editor with AI assistance

class AdvancedDeveloper {
    constructor(name) {
        this.name = name;
        this.skills = ['JavaScript', 'Python', 'AI/ML', 'Web Development'];
    }
    
    code() {
        console.log(\`\${this.name} is coding with AI assistance!\`);
    }
}

const omar = new AdvancedDeveloper('Omar Fergany');
omar.code();`,
                        language: 'javascript',
                        theme: document.documentElement.classList.contains('dark') ? 'vs-dark' : 'vs',
                        automaticLayout: true,
                        fontSize: 14,
                        minimap: { enabled: true },
                        scrollBeyondLastLine: false,
                        wordWrap: 'on'
                    });
                    
                    // Theme synchronization
                    const observer = new MutationObserver(() => {
                        const theme = document.documentElement.classList.contains('dark') ? 'vs-dark' : 'vs';
                        monaco.editor.setTheme(theme);
                    });
                    observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class'] });
                });
            }
        }
    }
    
    initResponsive() {
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        
        // Mobile responsiveness
        const handleResize = () => {
            if (window.innerWidth <= 768) {
                sidebar?.classList.add('collapsed');
            }
        };
        
        window.addEventListener('resize', handleResize);
        handleResize();
        
        // Mobile menu overlay
        if (window.innerWidth <= 768) {
            document.addEventListener('click', (e) => {
                if (!sidebar?.contains(e.target) && !sidebarToggle?.contains(e.target)) {
                    sidebar?.classList.remove('open');
                }
            });
        }
    }
    
    showWelcomeMessage() {
        if (this.aiAssistant) {
            setTimeout(() => {
                this.aiAssistant.addMessage(
                    "Welcome to Omar Fergany's Advanced AI Development Platform! 🚀\n\n" +
                    "I'm your intelligent assistant, powered by Google's Gemini AI. Here's what I can help you with:\n\n" +
                    "✨ **Smart Development Tools**\n" +
                    "• Code analysis and optimization\n" +
                    "• Image analysis and processing\n" +
                    "• Project planning and management\n" +
                    "• Real-time collaboration\n\n" +
                    "📊 **Professional Features**\n" +
                    "• Advanced analytics dashboard\n" +
                    "• Client and project management\n" +
                    "• Integrated code editor with AI assistance\n" +
                    "• Multi-language support\n\n" +
                    "🔗 **Contact Omar:**\n" +
                    "• Email: omarfergany100@gmail.com\n" +
                    "• WhatsApp: https://wa.me/201225860308\n" +
                    "• Website: Fergany71.github.io\n\n" +
                    "How can I assist you today?", 
                    'ai'
                );
            }, 1000);
        }
    }
}

class AIAssistant {
    constructor(apiKey) {
        this.apiKey = apiKey;
        this.messages = document.getElementById('chat-messages');
        this.input = document.getElementById('chat-input');
        this.sendBtn = document.getElementById('send-btn');
        this.quickActions = document.getElementById('quick-actions');
        this.fileInput = document.getElementById('file-input');
        this.attachBtn = document.getElementById('attach-btn');
        
        this.conversationHistory = [];
        this.currentMode = 'normal';
        this.uploadedFile = null;
        
        this.init();
    }
    
    init() {
        // Event listeners
        this.sendBtn?.addEventListener('click', () => this.sendMessage());
        this.input?.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                this.sendMessage();
            }
        });
        
        this.attachBtn?.addEventListener('click', () => this.fileInput?.click());
        this.fileInput?.addEventListener('change', (e) => this.handleFileUpload(e));
        
        // Quick actions
        this.quickActions?.addEventListener('click', (e) => {
            const action = e.target.closest('[data-action]')?.dataset.action;
            if (action) this.handleQuickAction(action);
        });
        
        // Auto-resize textarea
        this.input?.addEventListener('input', () => this.autoResize());
    }
    
    autoResize() {
        if (this.input) {
            this.input.style.height = 'auto';
            this.input.style.height = Math.min(this.input.scrollHeight, 120) + 'px';
        }
    }
    
    async sendMessage() {
        const message = this.input?.value.trim();
        if (!message && !this.uploadedFile) return;
        
        // Add user message
        this.addMessage(message, 'user', this.uploadedFile);
        
        // Clear input
        if (this.input) {
            this.input.value = '';
            this.input.style.height = 'auto';
        }
        
        // Clear uploaded file after sending
        const fileData = this.uploadedFile;
        this.uploadedFile = null;
        
        // Get AI response
        await this.getAIResponse(message, fileData);
    }
    
    addMessage(content, type, fileData = null) {
        if (!this.messages) return;
        
        const messageDiv = document.createElement('div');
        messageDiv.className = `message ${type}`;
        
        const avatarDiv = document.createElement('div');
        avatarDiv.className = 'message-avatar';
        avatarDiv.innerHTML = type === 'user' ? 'U' : '<i class="fas fa-robot"></i>';
        
        const contentDiv = document.createElement('div');
        contentDiv.className = 'message-content';
        
        if (type === 'ai') {
            contentDiv.innerHTML = marked.parse(content || '');
        } else {
            contentDiv.textContent = content;
            if (fileData && fileData.type.startsWith('image/')) {
                const img = document.createElement('img');
                img.src = fileData.url;
                img.style.maxWidth = '200px';
                img.style.marginTop = '0.5rem';
                img.style.borderRadius = '8px';
                contentDiv.appendChild(img);
            }
        }
        
        const timeDiv = document.createElement('div');
        timeDiv.className = 'message-time';
        timeDiv.textContent = new Date().toLocaleTimeString();
        contentDiv.appendChild(timeDiv);
        
        messageDiv.appendChild(avatarDiv);
        messageDiv.appendChild(contentDiv);
        
        this.messages.appendChild(messageDiv);
        this.messages.scrollTop = this.messages.scrollHeight;
    }
    
    async getAIResponse(message, fileData = null) {
        // Show typing indicator
        const typingDiv = document.createElement('div');
        typingDiv.className = 'message ai';
        typingDiv.innerHTML = `
            <div class="message-avatar"><i class="fas fa-robot"></i></div>
            <div class="message-content">
                <div class="spinner"></div>
                <span style="margin-left: 0.5rem;">AI is thinking...</span>
            </div>
        `;
        this.messages?.appendChild(typingDiv);
        this.messages.scrollTop = this.messages.scrollHeight;
        
        try {
            const systemPrompt = this.getSystemPrompt();
            let requestBody;
            
            if (fileData && fileData.type.startsWith('image/')) {
                // Image analysis
                requestBody = {
                    contents: [{
                        role: "user",
                        parts: [
                            { text: `${systemPrompt}\n\nUser message: ${message}` },
                            {
                                inlineData: {
                                    mimeType: fileData.type,
                                    data: fileData.base64
                                }
                            }
                        ]
                    }]
                };
            } else {
                // Text conversation
                const contents = [
                    { role: "user", parts: [{ text: systemPrompt }] },
                    ...this.conversationHistory,
                    { role: "user", parts: [{ text: message }] }
                ];
                requestBody = { contents };
            }
            
            const model = fileData && fileData.type.startsWith('image/') ? 'gemini-pro-vision' : 'gemini-1.5-flash';
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${this.apiKey}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(requestBody)
            });
            
            if (!response.ok) {
                throw new Error(`API Error: ${response.status}`);
            }
            
            const data = await response.json();
            const aiResponse = data.candidates?.[0]?.content?.parts?.[0]?.text || "I apologize, but I couldn't generate a response. Please try again.";
            
            // Remove typing indicator
            this.messages?.removeChild(typingDiv);
            
            // Add AI response
            this.addMessage(aiResponse, 'ai');
            
            // Update conversation history
            if (!fileData) {
                this.conversationHistory.push(
                    { role: "user", parts: [{ text: message }] },
                    { role: "model", parts: [{ text: aiResponse }] }
                );
                
                // Keep history manageable
                if (this.conversationHistory.length > 10) {
                    this.conversationHistory = this.conversationHistory.slice(-10);
                }
            }
            
        } catch (error) {
            console.error('AI Response Error:', error);
            this.messages?.removeChild(typingDiv);
            this.addMessage(`Sorry, I encountered an error: ${error.message}`, 'ai');
        }
    }
    
    getSystemPrompt() {
        return `You are Omar Fergany's advanced AI assistant, integrated into his professional development platform. You're an expert in:

• Web Development (React, Vue, Angular, Node.js)
• Mobile Development (Flutter, React Native) 
• AI/ML and Data Science
• Database Design and Management
• DevOps and Cloud Technologies
• Project Management and Business Analysis

Omar's Information:
- Full Name: Omar Atia Elfergany (عمر عطية الفرجاني)
- Email: omarfergany100@gmail.com
- WhatsApp: https://wa.me/201225860308
- Facebook: https://www.facebook.com/share/1B6Aef5zFx/
- Instagram: https://www.instagram.com/fergany___x
- Personal Website: Fergany71.github.io

You should:
1. Provide expert technical advice and solutions
2. Help with code analysis, debugging, and optimization
3. Assist with project planning and management
4. Answer questions about Omar's services and experience
5. Be professional, helpful, and knowledgeable
6. Use a mix of English and Arabic when appropriate

Always provide accurate, helpful, and professional responses.`;
    }
    
    handleQuickAction(action) {
        const actions = {
            'about-omar': () => this.addMessage(
                "Omar Fergany is a senior full-stack developer and AI specialist with expertise in modern web technologies, mobile development, and artificial intelligence. He specializes in creating innovative solutions that combine cutting-edge technology with excellent user experience.", 
                'ai'
            ),
            'contact-info': () => this.addMessage(
                "📧 **Email:** omarfergany100@gmail.com\n" +
                "📱 **WhatsApp:** https://wa.me/201225860308\n" +
                "🌐 **Website:** Fergany71.github.io\n" +
                "📘 **Facebook:** https://www.facebook.com/share/1B6Aef5zFx/\n" +
                "📸 **Instagram:** https://www.instagram.com/fergany___x", 
                'ai'
            ),
            'smart-tools': () => this.showSmartTools(),
            'code-review': () => this.addMessage(
                "I'd be happy to review your code! Please paste your code here and I'll analyze it for:\n\n" +
                "• Performance optimizations\n" +
                "• Best practices\n" +
                "• Security considerations\n" +
                "• Code structure improvements\n" +
                "• Bug detection", 
                'ai'
            ),
            'project-ideas': () => this.addMessage(
                "Here are some innovative project ideas you might find interesting:\n\n" +
                "🤖 **AI-Powered Projects:**\n" +
                "• Intelligent document processor\n" +
                "• Computer vision quality control system\n" +
                "• Natural language chatbot platform\n\n" +
                "🌐 **Web Applications:**\n" +
                "• Real-time collaboration platform\n" +
                "• Advanced project management suite\n" +
                "• E-commerce with AR try-on features\n\n" +
                "📱 **Mobile Apps:**\n" +
                "• IoT home automation controller\n" +
                "• Fitness tracking with AI coaching\n" +
                "• Social learning platform\n\n" +
                "Would you like me to elaborate on any of these ideas?", 
                'ai'
            ),
            'image-analysis': () => {
                this.addMessage(
                    "I can analyze images for you! Please upload an image and I'll help you with:\n\n" +
                    "📸 **Image Analysis:**\n" +
                    "• Object detection and recognition\n" +
                    "• Text extraction (OCR)\n" +
                    "• Image description and details\n" +
                    "• Quality assessment\n" +
                    "• Color analysis\n\n" +
                    "Click the attachment button to upload an image!", 
                    'ai'
                );
                this.fileInput?.click();
            }
        };
        
        actions[action]?.();
    }
    
    showSmartTools() {
        this.addMessage(
            "🔧 **Available Smart Tools:**\n\n" +
            "💻 **Development Tools:**\n" +
            "• Code review and optimization\n" +
            "• Database design assistance\n" +
            "• API testing and documentation\n" +
            "• Performance analysis\n\n" +
            "🤖 **AI-Powered Features:**\n" +
            "• Image analysis and processing\n" +
            "• Text analysis and summarization\n" +
            "• Code generation and explanation\n" +
            "• Project planning assistance\n\n" +
            "📊 **Business Tools:**\n" +
            "• Client management\n" +
            "• Project analytics\n" +
            "• Resource planning\n" +
            "• Performance tracking\n\n" +
            "Which tool would you like to use?", 
            'ai'
        );
    }
    
    handleFileUpload(event) {
        const file = event.target.files[0];
        if (!file) return;
        
        const reader = new FileReader();
        reader.onload = (e) => {
            this.uploadedFile = {
                name: file.name,
                type: file.type,
                size: file.size,
                url: e.target.result,
                base64: e.target.result.split(',')[1]
            };
            
            // Show file preview
            this.addMessage(`File uploaded: ${file.name}`, 'user', this.uploadedFile);
        };
        reader.readAsDataURL(file);
        event.target.value = '';
    }
}

// Initialize the platform when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    window.platform = new AdvancedPlatform();
});

// PWA Service Worker Registration
if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
        navigator.serviceWorker.register('/sw.js')
            .then(() => console.log('Service Worker registered'))
            .catch(() => console.log('Service Worker registration failed'));
    });
}
</script>========================</body>
</html>          this.messages.appendChild(div);
          this.messages.scrollTop = this.messages.scrollHeight;
      },

      showQuickReplies(replies) {
          this.quickReplies.innerHTML = '';
          if (!replies || replies.length === 0) {
              this.quickReplies.style.display = 'none'; return;
          }
          this.quickReplies.style.display = 'flex';
          replies.forEach(reply => {
              const btn = document.createElement('button');
              btn.className = 'quick-reply-btn';
              if (reply.isGemini) btn.classList.add('gemini-feature');
              btn.textContent = reply.text;
              btn.onclick = () => this.handleQuickReply(reply);
              this.quickReplies.appendChild(btn);
          });
      },
      
      getSystemPrompt(mode, prompt) {
          switch(mode) {
              case 'image_analysis': return `أنت خبير تحليل صور عالمي. مهمتك هي تحليل الصورة المقدمة بدقة والإجابة على سؤال المستخدم عنها باللهجة المصرية. كن دقيقاً ومفصلاً في تحليلك. سؤال المستخدم هو: "${prompt}"`;
              case 'code_explain': return `أنت خبير برمجة ومدرس ممتاز باللهجة المصرية. اشرح الكود التالي بوضوح: \`\`\`\n${prompt}\n\`\`\``;
              case 'idea_generation': return `أنت خبير تقني ومستشار إبداعي. ولّد فكرة مشروع مبتكرة عن: "${prompt}"`;
              case 'email_draft': return `أنت مساعد كتابة محترف. اكتب مسودة إيميل عن: "${prompt}"`;
              case 'learning_path': return `أنت مرشد تقني وخبير تعليمي. أنشئ خطة تعلم لـ: "${prompt}"`;
              case 'code_refactor': return `أنت مهندس برمجيات خبير. حلل وحسّن الكود التالي مع شرح التغييرات: \`\`\`\n${prompt}\n\`\`\``;
              case 'regex_generator': return `أنت خبير عالمي في Regex. حوّل الوصف التالي إلى نمط Regex مع شرحه: "${prompt}"`;
              case 'translation': return `أنت مترجم فوري محترف. ترجم النص التالي مع الحفاظ على السياق واللهجة إن أمكن: "${prompt}"`;
              case 'summarization': return `أنت باحث وخبير في تلخيص المعلومات. لخص النص التالي في نقاط واضحة وموجزة: "${prompt}"`;
              default: return `أنت مساعد ذكاء اصطناعي شخصي لمطور ويب اسمه عمر عطيه الفرجانى. 

معلومات المطور:
- الاسم: عمر الفرجانى (Omar Fergany)
- البريد الإلكتروني: omarfergany100@gmail.com
- واتساب: https://wa.me/201225860308
- فيسبوك: https://www.facebook.com/share/1B6Aef5zFx/
- إنستجرام: https://www.instagram.com/fergany___x
- الموقع الشخصي: Fergany71.github.io

مهمتك الحالية هي الإجابة على أسئلة المستخدم عن عمر والمساعدة في أي استفسارات تقنية. كن ودوداً ومفيداً واستخدم اللهجة المصرية في الحديث.`;
          }
      },

      async getAIResponse(prompt, mode, imageData = null) {
          const loadingDiv = document.createElement('div');
          loadingDiv.className = 'message ai';
          loadingDiv.innerHTML = `<div class="ai-avatar"><i class="fas fa-robot"></i></div><div><span style="animation: pulse 1.5s infinite ease-in-out;">يكتب الآن...</span></div>`;
          this.messages.appendChild(loadingDiv);
          this.messages.scrollTop = this.messages.scrollHeight;
          
          // ==================================================================
          // START: MODIFIED SECTION - الاتصال المباشر بـ Gemini API
          // ==================================================================
          
          // !!! هام جداً: استبدل النص التالي بمفتاح API الخاص بك من Google AI Studio
          const API_KEY = "AIzaSyD39lIpfEjoPYM6NcOxWtM3pQym9ZrkXfo"; 

          if (API_KEY === "الرجاء وضع مفتاح GEMINI API الخاص بك هنا") {
              this.messages.removeChild(loadingDiv);
              this.addMessage("**خطأ إعداد:** لم يتم تعيين مفتاح Gemini API. يرجى تعديل الكود في السطر 563 وإضافة المفتاح الخاص بك لتشغيل المساعد.", 'ai');
              return;
          }

          // تحديد النموذج المناسب: gemini-pro-vision للصور، و gemini-1.5-flash للنصوص
          const model = (mode === 'image_analysis' && imageData) ? 'gemini-pro-vision' : 'gemini-1.5-flash';
          const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${API_KEY}`;
          
          // ==================================================================
          // END: MODIFIED SECTION
          // ==================================================================

          const systemPrompt = this.getSystemPrompt(mode, prompt);
          let contents;
          
          if (mode === 'image_analysis' && imageData) {
              contents = [{ role: "user", parts: [{ text: systemPrompt }, { inlineData: { mimeType: imageData.mimeType, data: imageData.base64 } }] }];
          } else if (mode === 'normal') {
              // إضافة prompt النظام قبل سجل المحادثة
              this.history.unshift({ role: "model", parts: [{ text: this.getSystemPrompt('normal') }] });
              contents = [...this.history, { role: "user", parts: [{ text: prompt }] }];
          } else {
              contents = [{ role: "user", parts: [{ text: systemPrompt }] }];
          }
          
          const payload = { contents };
          
          try {
              const response = await fetch(API_URL, {
                  method: 'POST',
                  headers: { 'Content-Type': 'application/json' },
                  body: JSON.stringify(payload)
              });
              
              if (!response.ok) {
                  const errorData = await response.json();
                  throw new Error(errorData.error.message || `HTTP ${response.status}`);
              }
              
              const data = await response.json();
              this.messages.removeChild(loadingDiv);
              
              if (data.candidates && data.candidates[0].content && data.candidates[0].content.parts) {
                  const aiText = data.candidates[0].content.parts[0].text;
                  this.addMessage(aiText, 'ai');
                  
                  if (mode === 'normal') {
                      this.history.push({ role: "user", parts: [{ text: prompt }] });
                      this.history.push({ role: "model", parts: [{ text: aiText }] });
                  } else {
                      this.addMessage("هل أقدر أساعدك في حاجة تانية؟", "ai");
                      this.loadInitialState(); // الرجوع للحالة الأولية بعد استخدام أداة ذكية
                  }
              } else {
                   // التعامل مع الردود الفارغة بسبب فلاتر الأمان
                  const finishReason = data.candidates?.[0]?.finishReason;
                  if (finishReason === 'SAFETY') {
                       this.addMessage("لم أتمكن من إنشاء رد بسبب إعدادات الأمان. حاول تغيير صياغة سؤالك.", 'ai');
                  } else {
                       this.addMessage("معلش، شكلي سرحت شوية. ممكن تسأل تاني؟", 'ai');
                       console.log("Unexpected response structure:", data);
                  }
              }
          } catch (error) {
              console.error("API Error:", error);
              this.messages.removeChild(loadingDiv);
              let displayError = `عفواً، حصل خطأ فني: ${error.message}.`;
              if (error.message.includes('API key not valid')) {
                  displayError = "خطأ: مفتاح API الذي أدخلته غير صالح. يرجى التحقق منه.";
              }
              this.addMessage(displayError, 'ai');
          } finally {
              if (this.history.length > 8) { 
                  this.history = this.history.slice(-8); 
              }
              // التأكد من إعادة تعيين الحالة بعد استخدام أداة ذكية
              if (mode !== 'normal') { 
                  this.chatMode = 'normal';
                  this.uploadedImageData = null;
                  this.input.placeholder = "اسأل أي حاجة عن المطور عمر...";
              }
          }
      }
  };

});
</script>
</body>
</html>

